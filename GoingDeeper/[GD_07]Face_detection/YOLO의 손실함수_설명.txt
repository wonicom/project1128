YOLO의 손실함수는 세부분으로 나누어진다고 보시면 될 것 같습니다. 첫번째는 Confidence Loss입니다. 예측된 경계 상자에 개체가 있는지 확인합니다. 이 손실 함수는 모델이 배경과 전경 영역을 구별하는데 도움이 됩니다. 다음은 Localization Loss입니다. 예측 상자에 객체가 포합된 경우에만 적용됩니다. 마지막 Classification Loss는 예측 상제의 개체가 속하는 범주를 결정합니다.

좀더 구체적으로 살펴보도록 하겠습니다. 지금 보시는 부분은 Localization loss로 예측된 경계 상자 위치 및 크기의 오류를 측정하여 물체 감지를 담당하는 상자만 계산합니다. 먼저 위에 있는 수식의 경우 예측한 바운딩 박스의 중심 좌표 Xi hat, Yi hat과 ground truth의 중심좌표 Xi, Yi의 오차 제곱을 나타내는 식이 아래 width, height도 마찬가지로 오차 제곱을 나타내고 있습니다. 수식을 살펴보시면 위치는 sum squared error를 그대로 적용하지만 크기에 대해서는 각 높이와 너비에 대해 루트 값을 씌워 계산합니다. 이렇게 하는 이유는 절대 수치로 계산을 하게 되면 큰 box의 오차가 작은 box의 오차보다 훨씬 큰 가중치를 받게 됩니다. 정리하면 작은 박스의 경우 예측오차가 상대적으로 작아져 작은 박스만을 찾게 되는 것을 조금 완화하고자 한 것이라 생각합니다.(object의 절대적인 값이 큰 경우에 절대적인 오류도 커지는 것을 막기 위해 나타낸 것)

위 인용을 보면 "responsible"이라는 개념은 그리드 셀에 대해서도, 바운딩 박스에 대해서도 쓰입니다. 하지만 로스의 관점에서 "responsible"은 결국 바운딩 박스에 대한 개념으로 생각하면 됩니다. 즉 하나의 물체에 대한 예측을 책임지는 유일한 바운딩 박스를 결정하는 문제입니다. 수식을 보면 예측에 대해 "responsible"하지 않은 박스의 좌표 크기 로스 텀은 0이 되는 것을 알 수 있습니다. 즉 책임이 없는 박스들에 대해서는 좌표와 크기의 로스를 면제해주자는 아이디어입니다. 즉 어떤 물체의 중심을 포함하는 셀에서 예측된 바운딩 박스 중 실제 바운딩 박스와 가장 큰 IOU를 갖는 박스를 그 물체에 대해 "responsible"하다고 말합니다.

(다시 이전 슬라이드로 돌아가서)obj라고 적혀 있는 이 부분이 "resposible"과 관련있는 부분입니다. i번째 cell 안의 2개 detector 중에서 j번째 detector가 responsible이면 1이고, not reponsible이면 0입니다. 즉 responsible을 정의하는데에는 object와 detector 모두 관여합니다. 좀더 구체적으로 이야기하면 (1)object의 center가 속하는 i번째 cell이면서, 해당 cell의 detector 2개 중 object와 가장 높은 IOU를 갖는 1개 detector가 resposible이 됩니다. 람다coord의 경우 스케일링을 적용한 것인데, 이는 뒤에 나오는 다른 두개의 로스들과 일종의 균형을 맞춰주기 위한 벨런싱 파라미터라고 보시면 됩니다(보통 설정이 5로 됩니다)

다음 살펴볼 loss는 Confidence loss입니다. 지금 보시는 공식은 객체가 탐지된 경우의 식이고 다음 보시는 공식은 객체가 탐지되지 않은 경우입니다. 여기서 주목해야할 점은 바로 object가 없어야 하는 확률에 대해서도 b-box의 confidence loss를 구해서 포함시킨다는 점입니다. 람다noobj loss에는 람다 가중치를 곱해줍니다. 보통 값은 0.5입니다. object 객체가 탐지되지 않은 영역에 대한 loss를 0.5를 곱해서 낮춰주는 이유는 클래스 불균형 문제를 방지하기 위함입니다. 대부분의 Box가 객체를 포함하고 있지 않은 경우가 더 많기 때문에 배경에 대한 가중을 줄이지 않는 경우 배경을 탐지하는 모델로 훈련될 수 있습니다.

마지막은 Classification loss입니다. Pi(c)는 실제 class probabilities를 나타내고 P^i(c)는 예측한 class probabilities를 나타냅니다. 즉 말 그대로 클래스별 확률 값에 대한 오차 제곱을 구해주게 됩니다. 